<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>İşletme Yönetimi - S.S.S</title>
    <link rel="stylesheet" href="styles3.css">
    <script src="/frontend/src/js/businessInfo.js"></script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <img id="business-image" src="/frontend/src/assets/images/default-image.png" alt="İşletme Fotoğrafı">
            <h1 id="sidebar-h1">Varsayılan İşletme</h1>
            <h2 id="sidebar-h2">Panel</h2>
            <nav>
                <ul>
                    <li><a href="/frontend/public/pages/musteri_panel/randevu_al/index1.html">Randevu Al</a></li>
                    <li><a href="/frontend/public/pages/musteri_panel/galeri/index15.html">Galeri</a></li>
                    <li><a href="/frontend/public/pages/musteri_panel/sss/index3.html">Sıkça Sorulan Sorular</a></li>
                    <li><a href="/frontend/public/pages/musteri_panel/iletisim/index2.html">İletişim</a></li>
                </ul>
            </nav>
        </aside>

        <button class="mobile-menu-toggle" id="menu-toggle">&#9776;</button>
        
        <header class="mobile-header" id="mobile-header">
            <img id="mobile-business-image" src="/frontend/src/assets/images/default-image.png" alt="İşletme Fotoğrafı">
            <h1 id="mobile-business-name">İşletme Adı</h1>
        </header>

        <div class="mobile-menu" id="mobile-menu">
            <ul>
                <li><a href="/frontend/public/pages/musteri_panel/randevu_al/index1.html">Randevu Al</a></li>
                <li><a href="/frontend/public/pages/musteri_panel/galeri/index15.html">Galeri</a></li>
                <li><a href="/frontend/public/pages/musteri_panel/sss/index3.html">Sıkça Sorulan Sorular</a></li>
                <li><a href="/frontend/public/pages/musteri_panel/iletisim/index2.html">İletişim</a></li>
            </ul>
        </div>

        <main class="main-content">
            <div class="preview">
                <h2>Sıkça Sorulan Sorular</h2>
                <div class="preview-box" id="faqDisplay"></div>
            </div>
        </main>
    </div>
<script>
    
    document.addEventListener('DOMContentLoaded', async function () {
        await loadBusinessInfo();

        // --- SSS (FAQ) verilerini çek ---
        const faqDisplay = document.getElementById('faqDisplay');
        if (faqDisplay) {
            try {
                const response = await fetch("http://127.0.0.1:8000/api/sss");
                const faqs = await response.json();

                faqs.forEach(faq => {
                    const faqItem = document.createElement('div');
                    faqItem.classList.add('faq-item');

                    const questionButton = document.createElement('button');
                    questionButton.classList.add('accordion');
                    questionButton.innerHTML = faq.soru + '<span class="symbol"> + </span>';

                    const answerDiv = document.createElement('div');
                    answerDiv.classList.add('panel');
                    answerDiv.style.maxHeight = '0';

                    const answerPara = document.createElement('p');
                    answerPara.classList.add('answer');
                    answerPara.textContent = faq.cevap;

                    answerDiv.appendChild(answerPara);
                    faqItem.appendChild(questionButton);
                    faqItem.appendChild(answerDiv);
                    faqDisplay.appendChild(faqItem);

                    questionButton.addEventListener('click', function () {
                        const panel = this.nextElementSibling;
                        if (panel.style.maxHeight && panel.style.maxHeight !== '0px') {
                            panel.style.maxHeight = '0';
                            this.querySelector('.symbol').textContent = ' + ';
                        } else {
                            panel.style.maxHeight = panel.scrollHeight + 'px';
                            this.querySelector('.symbol').textContent = ' - ';
                        }
                    });
                });
            } catch (error) {
                console.error("SSS verileri alınamadı:", error);
                faqDisplay.innerHTML = "<p>Sıkça sorulan sorular yüklenemedi.</p>";
            }
        }

        // --- Mobil menü aç/kapat ---
        const menuToggle = document.getElementById("menu-toggle");
        const mobileMenu = document.getElementById("mobile-menu");

        if (menuToggle && mobileMenu) {
            menuToggle.addEventListener("click", () => {
                mobileMenu.classList.toggle("open");
            });
        }
    });

        window.addEventListener("DOMContentLoaded", async () => {
            try {
                const response = await fetch("http://localhost:8000/api/genel-ayarlar/liste");
                const ayarlar = await response.json();
                const ayar = ayarlar[0];

                if (ayar) {
                    // Ana başlık ve alt başlığı tüm sayfalarda güncelle
                    if (ayar.logo) {
                        document.getElementById("business-image").src = ayar.logo;
                        const mobileImage = document.getElementById("mobile-business-image");
                        if (mobileImage) mobileImage.src = ayar.logo;
                    }

                    if (ayar.isletme_adi) {
                        document.getElementById("sidebar-h1").textContent = ayar.isletme_adi;
                        const mobileName = document.getElementById("mobile-business-name");
                        if (mobileName) mobileName.textContent = ayar.isletme_adi;
                    }

                    if (ayar.aciklama) {
                        const subtitle = document.getElementById("sidebar-h2");
                        if (subtitle) subtitle.textContent = ayar.aciklama;
                    }
                }
            } catch (error) {
                console.error("Genel ayarlar alınamadı:", error);
            }
        });

</script>

</body>
</html>